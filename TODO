Stabilise enough to write tests

Remove explicit rules entirely, discover them.
Discover rules even when we take multiple steps.

Performance:
- deriving factor is very slow

Sets, type checking, inequalities, constraints.
- \Aa \e \Z, a > 10: ...

Abstract out knowledge of operators:
- arg number and types, return type
- rules
- constructing the grammar will be hard

